(function(b){var a=function(d){var c=b('<div class="slider"><div class="loader"><span class="spinner"></span> Loading photos... (<span class="percent">0</span>%)</div><div class="slide-images"></div><div class="options"><a class="prevSlide" href="javascript:;">prev</a><span class="slide-pager"></span><a class="nextSlide" href="javascript:;">next</a></div></div>');c.find(".slide-images").append(b.map(d.slides,function(e){return b('<div class="slide-image">'+(e.link?'<a href="'+e.link+'" target="_blank">':"")+'<img src="'+e.src+'"><span class="caption">'+e.name+"</span>"+(e.link?"</a>":"")+"</div>")[0]}));c.find(".slide-pager").append(b.map(d.slides,function(e,f){return b('<a href="javascript:;">'+(f+1)+"</a>")[0]}));return c};window.Slider=function(c){var d=this;d.container=b(c);d.current=0;d.lastHumanNav=0;d.duration=5000;d.slide=function(e){e=Math.max(0,Math.min(e,d.slides.size()-1));if(d.node){d.slides.eq(d.current).removeClass("current");d.slides.eq(e).addClass("current");d.pages.eq(d.current).removeClass("current");d.pages.eq(e).addClass("current")}d.current=e;return d};d.next=function(){var e=d.current+1;if(e>=d.slides.size()){e=0}d.slide(e)};d.prev=function(){var e=d.current-1;if(e<0){e=d.slides.size()-1}d.slide(e)};d.setDuration=function(e){d.duration=e&&e>0?e:5000;return d};d.setTransition=function(e){if(d.node){d.transition&&d.node.removeClass(d.transition);e&&d.node.addClass(e)}d.transition=e;return d};d.setTheme=function(e){if(d.node){d.theme&&d.node.removeClass(d.theme);e&&d.node.addClass(e)}d.theme=e;return d};d.setSize=function(e,f){d.w=e;d.h=f;if(d.node){d.node.width(e);d.node.find(".slide-image").width(e);d.node.find(".slide-images, .slider-image").height(f)}return d};d.fetchJson=function(g,f,e){var h=b.extend({},f);if(!e){e=function(i){return i}}d.container.empty();b.getJSON(g,h,function(i){d.setPhotos(e(i))});return d};d._sync=function(){d.setTransition(d.transition);d.setTheme(d.theme||"theme-dark");d.setSize(d.w||"640px",d.h||"430px");d.slides&&d.slide(d.current||0)};d.setPhotos=function(f){d.node=a({slides:f}).addClass("loading");d.container.empty().append(d.node);d.current=0;d._sync();var e=0;var g=d.node.find(".slide-image img").bind("load",function(){var h=g.size();if(++e==h){d.node.removeClass("loading");d.start()}d.node.find(".loader .percent").text(Math.floor(100*e/h))});if(g.size()==0){d.node.find(".loader").text("No photo")}return d};d.start=function(){d._sync();d.slides=d.node.find(".slide-image");d.pages=d.node.find(".slide-pager a");d._bind();d.slides.removeClass("current").eq(d.current).addClass("current");d.pages.removeClass("current").eq(d.current).addClass("current");return d};d._bind=function(){d.node.find(".prevSlide").click(function(){d.prev()});d.node.find(".nextSlide").click(function(){d.next()});d.node.find(".slide-pager a").each(function(g){b(this).click(function(){d.slide(g)})});var f=function(){return new Date().getTime()};d.node.find(".options a").click(function(){d.lastHumanNav=f()});if(!d.timeout){var e=function(){if(f()-d.lastHumanNav>2000){d.next()}d.timeout=setTimeout(e,d.duration)};d.timeout=setTimeout(e,d.duration)}return d}}}(jQuery));